# 腹筋が早ければ早いほどイケメンになれるプログラム

## 使い方

※割愛

## 設定など

`constants`タブの変数をいじればおおよそ何とかなるよ

### WIDTH

画面のサイズ（幅）

### HEIGHT

画面のサイズ（高さ）

### DELAY_TIME

最初にPCの録画デバイスを検出しているが、1回では上手くいかないことが多い。
そのためループにすることで、検出できなかった場合はリトライするようにしている。
そのループごとの待機時間（ミリ秒）の設定用変数。

### DETECTION_DISTANCE_THRESHOLD

各フレームで顔の領域（正方形）を検出しているが、たまに変な位置を顔だと認識してしまう。
よほど早く動かない限りは、顔の検出位置は各フレーム間でほとんど移動しないため、
しきい値を設定して誤検出時の更新をスキップするようにしている。
このしきい値を超えた場合、ログが出力される（例：`Too far! Skip updating position. dist: 100.0000`）

### DETECTION_SIZE_THRESHOLD

顔の検出領域が一定のサイズ以上になった場合を良判定（腹筋した）とみなしている。
そのサイズのしきい値を設定する定数。
実行途中でもしきい値は変更可能（後述）で、初期値がこの変数の値となる。

### DETECTION_TIME_THRESHOLD

前回の良判定から、この変数で指定した時間（ミリ秒）だけ良判定としないようにしている。
しきい値付近で検出領域のサイズがぶれると正確なスコアが出せないため。
体を起こしきっていない状態から安定して起こした状態になるまでに必要な時間を指定する。

### ELAPSED_TIME_RANGE

- 2つの時間（ミリ秒、A,Bとする）を指定する。
- 前回の良判定から次の良判定までの時間がAミリ秒以下ならイケメン画像100%
- 前回の良判定から次の良判定までの時間がAミリ秒以上,Bミリ秒以下なら、それに応じてイケメン画像と井上画像をブレンドする（線形に割合を決定している）
- 前回の良判定から次の良判定までの時間がBミリ秒以上なら井上画像100%

### DEBUG_SHOW_DETECTED_AREA_FLAG

`true`の場合、顔検出領域を黄緑色の枠で表示する

### DEBUG_NO_IMAGE_FLAG

`true`の場合、画像の読み込みは行わなくなる。
スコアが低いほど顔が見えづらくなり、スコアが高いほどはっきりと見えるようになる。

### DEBUG_EMPHASIZE_DETECTED_TIMING_FLAG

`true`の場合、良判定の（体を起こしきっていない状態から起こした状態になる）ときに
画面が一瞬赤く光るようになり、タイミングがわかりやすくなる。

## 実行中に良判定となる顔検出領域サイズしきい値を変更する

これは `DEBUG_SHOW_DETECTED_AREA_FLAG` と組み合わせるとわかりやすい。
画面をクリックすると、現在の顔検出領域サイズをしきい値として設定する。
しきい値が更新された場合、ログが出力される（例：`Set detection size threshold: 300.0`）